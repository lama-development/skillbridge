<div class="card shadow-sm mb-4">
  <div class="card-body p-4">
    <div class="d-flex align-items-center mb-3">
      <% 
        let defaultImg = 'img/freelancer.png';
        if (post.type === 'job_offer') defaultImg = 'img/business.png';
      %>
      <img src="<%= post.profilePicture || defaultImg %>" alt="Profile" class="rounded-circle me-3 profile-img-small">
      <div>
        <h5 class="card-title mb-0">
          <%- post.title %>
          <% if (post.type === 'job_offer') { %>
            <span class="badge bg-secondary ms-2">Azienda</span>
          <% } else { %>
            <span class="badge bg-primary ms-2">Freelancer</span>
          <% } %>
          <% if (post.category) { %>
            <span class="badge bg-light text-dark ms-1"><%= post.category %></span>
          <% } %>
        </h5>
        <p class="text-muted mb-0 small">
          <% if (post.type === 'job_offer') { %>
            <%- post.businessName || post.businessName %>
          <% } else { %>
            <%- post.fullName %>
          <% } %>
          â€¢ <%= new Date(post.createdAt).toLocaleDateString('it-IT') %>
        </p>
      </div>
    </div>
    <p class="card-text"><%- post.content %></p>
    <% if (!user || (user && post.userId !== user.username)) { %>
      <a href="/profile/<%= post.username %>" class="btn btn-outline-primary btn-sm">
        <i class="bi bi-person-circle me-1"></i> Visita profilo
      </a>
      <a href="/chat/<%= post.username %>" class="btn btn-outline-primary btn-sm">
        <i class="bi bi-chat-dots-fill"></i> Inizia chat
      </a>
    <% } %>
    <% if (user && user.username === post.userId) { %>
      <form action="/posts/<%= post.id %>/delete" method="POST" class="d-inline-block ms-2">
        <button type="submit" class="btn btn-outline-danger btn-sm" onclick="return confirm('Sei sicuro di voler eliminare questo post?')">
          <i class="bi bi-trash-fill me-1"></i> Elimina
        </button>
      </form>
    <% } %>
  </div>
</div>